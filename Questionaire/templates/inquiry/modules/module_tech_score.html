{% load score_result_tags %}

<div class="card {{ widget.extra_card_class }}">
    <div class="card-header py-0 {{ widget.extra_header_class }}" id="{{ widget.tech_id }}">
        <h5 class="mb-0">
            <div class="row">
                {% if widget.technology.icon %}
                    <img class="" src="{{ widget.technology.icon.url }}" width="50" height="50">
                {% endif %}
                <div class="col py-3"> {{ widget.technology.name }}</div>

                {% if widget.technology.score %}
                    <div class="col text-right py-3 {{ widget.technology.score|get_font_class_for_score }}">
                        {{ widget.technology.score|get_text_base_score }}
                    </div>
                {% else %}
                    {% with widget.technology|get_tech_score:widget.inquiry as score %}
                        <div class="col text-right py-3 {{ widget.score|get_font_class_for_score }}">
                            {{ widget.score|get_text_base_score }}
                        </div>
                    {% endwith %}
                {% endif %}
            </div>
        </h5>
    </div>
</div>
<div class="p-2">
    <h3>{{ widget.technology.name }}</h3>
    <p>
        {{ widget.technology.short_text }}
        {% with widget.technology.get_absolute_url as url %}
            {% if url %}
                <a target="_blank" rel="noopener noreferrer" href="{{ url }}" > (learn more) </a>
            {% endif %}
        {% endwith %}
    </p>

    {% if widget.technology.sub_technologies.exists %}
        {% for tech_score in widget.technology|get_tech_scores:widget.inquiry %}
            {% for note in widget.tech_score|get_score_notes:widget.technology %}
                <p>
                    {{ widget.note|get_prepped_text:widget.inquiry }}
                </p>
            {% endfor %}
        {% endfor %}

        Er zijn verscheidene maatregelen die mogelijk zijn. Hieronder zetten wij uit welke maatregelen wij aanraden:
        {% with widget.technology|create_sub_tech_accordion_name as accordion_id %}
            <div id="{{ accordion_id }}">
                {% for subtech in widget.technology.sub_technologies.all %}
                    {% with subtech|get_subtech_html_id:widget.technology as tech_id %}
                        {% include "inquiry/inquiry_snippets/snippet_tech_group_accordion.html" with is_subtech=1 technology=subtech extra_card_class='text-dark' extra_header_class='' %}
                    {% endwith %}
                {% endfor %}

            </div>
        {% endwith %}
    {% else %}
        <h4>Ons advies: {{ widget.technology|get_tech_score:widget.inquiry|get_text_base_score }}</h4>
        {% for tech_score in widget.technology|get_tech_scores:widget.inquiry %}
            {% for note in tech_score|get_score_notes:widget.technology %}
                <p>
                    {{ note|get_prepped_text:widget.inquiry }}
                </p>
            {% endfor %}
        {% endfor %}
    {% endif %}
</div>